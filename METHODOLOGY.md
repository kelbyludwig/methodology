# Methodology

## Web Applications and Web Services

### Discovery

* Use the Burp Extension "Identity Crisis" to identify pages that respond
  differently to different browsers.

#### References

* [Identity Crisis Burp Extension](https://github.com/EnableSecurity/Identity-Crisis) 

### OIDC, SAML, SSO, OAuth

### RefXSS, Stored XSS, DOM XSS

#### Candidate Point Discovery 

* Use specific values when interacting with the application during discovery to
  help trace where data is propagated. e.g. "KelbyAAAA", "KelbyAAAB", "555-666-7777"

* Use Burp Extension "Reflected Parameters" to detect reflected candidates.

* Check out third-party JS libraries and how they are used to find known
  vulnerabilities or insecure (likely not thoroughly reviewed by the
  first-party) implementations.

* File upload/download can often expose XSS threat vectors via XML, SVG, HTML,
  and SWF files.

#### Vulnerability Identification

* Use XSS Polyglots to minimize number of requests issued.

* Use payloads generated by XSS Hunter, Sleepy Puppy, or Burp Active Scan (i.e.
  the Collaborator-based ones) to assist with identification of blind XSS or 
  less-obvious triggers.

* Ensure Chrome developer logs are visible to identify any payloads that
  trigger without a direct effect on the UI (e.g. syntax errors, XSS Auditor,
  CSP violations). Also, I find that XSS payloads are far more likely to
  trigger by-default in Firefox.

* Use headless browsers to automate vulnerability detection. This was done by 
  NVisium with XSS Validator.

#### Exploitation

* "Script Gadgets" can be used to bypass several XSS prevention mechanisms.

#### Inspiration



#### References

* [The Bug Hunters Methodology: Tactical XSS Fuzzing](https://github.com/jhaddix/tbhm/blob/master/05_XSS.md)

* [XSS Polyglots](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Polyglots/XSS_Polyglots.txt)

* [Reflected Parameters Burp Extension"](https://github.com/PortSwigger/reflected-parameters) 

* [XSS Hunter](https://xsshunter.com/)

* [Sleepy Puppy](https://github.com/Netflix/sleepy-puppy)

* [HTML5 Security Cheatsheet](https://github.com/cure53/H5SC)

* [xssValidator](https://nvisium.com/blog/2014/01/31/accurate-xss-detection-with-burpsuite/)

* [Breaking XSS Mitigations via Script Gadgets](https://2017.appsec.eu/presos/Hacker/Don%E2%80%99t%20trust%20the%20DOM%20Bypassing%20XSS%20mitigations%20via%20Script%20gadgets%20-%20Sebastian%20Lekies,%20Krzystof%20Kotowicz%20and%20Eduardo%20Vela%20Nava%20-%20OWASP_AppSec-Eu_2017.pdf)





## Inspiration and Ideas

* [Popping a shell on the Oculus developer portal](https://bitquark.co.uk/blog/2014/08/31/popping_a_shell_on_the_oculus_developer_portal)

    * Blind SQLi via spoofed proxy headers recovered admin-privilege sessions.
      The admin panel allowed for pretty silly RCE vulns (which also wasn't
      CSRF protected).

* [How I got access to millions of redacted accounts](https://bitquark.co.uk/blog/2016/02/09/how_i_got_access_to_millions_of_redacted_accounts) 

    * SSRF in multiple endpoints leaked server-to-server JWTs. These
      JWTs authenticated particular services. A particular endpoint vulnerable
      to SSRF leaked a "superuser"-signed JWT.

* [Turning Self-XSS Into Good-XSS](https://whitton.io/articles/uber-turning-self-xss-into-good-xss/) 

    * The author leverages a Self-XSS payload and Logout/Login CSRF to increase the
      impact of self-xss.

* [XSS on Facebook with Wonky Content-Types](https://whitton.io/articles/xss-on-facebook-via-png-content-types/) 

    * The author uses file upload/download functionality and server-side
      `content/type` manipulation to trick the browser into executing a PNG as
      JS (XSS via Content Sniffing).

* [Using a Braun Shaver to Bypass XSS Audit and WAF](https://blog.bugcrowd.com/guest-blog-using-a-braun-shaver-to-bypass-xss-audit-and-waf-by-frans-rosen-detectify)

    * Using reflected XML injection, regexp bypasses, XML namespaces, and some
      other tricks to trigger XSS.

* [Bypassing Google Authentication on Periscope's Admin Panel](https://whitton.io/articles/bypassing-google-authentication-on-periscopes-admin-panel/)

    * Due to a misconfiguration on the Relying Party (Periscope) and incorrect
      assumptions about GSuite's OIDC implementation, any Google account could
      have been used to authenticate to the Periscope admin panel.

* [Papyal XML Upload Cross Site Scripting Vulnerability](https://blog.it-securityguard.com/bugbounty-papyal-xml-upload-cross-site-scripting-vulnerability/)

    * File upload allowed XML upload. Files were also accessible for all users
      via a direct link, so the author uploaded HTML-namespaced XML to trigger 
      an XSS payload.
